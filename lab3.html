<!DOCTYPE html>
<html>
    <head>
    <title>myGame</title>
    <style>
        canvas {
        border:1px solid #000000;
        background-image: #f1f1f1;
        }
    </style>
    <script>
        function getRandomInt(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min) + min); // The maximum is exclusive and the minimum is inclusive
        }

        const MIN_COMPS = 10;
        const MAX_COMPS = 50;
        const MIN_COMP_SPEED = -6;
        const MAX_COMP_SPEED = 6;
        const COMP_SIZE = 30;
        const CANVAS_WIDTH = 1200;
        const CANVAS_HEIGHT = 600;
        const TEXT_POS_X = 900;
        const TEXT_POS_Y = 20;

        var components_left = getRandomInt(MIN_COMPS, MAX_COMPS);
        var components_clicked = 0;
        
        // var myGamePiece;
        var myGamePieces = [];

        function startGame() {
            for (i = 0; i < components_left; i++) {
                var x_pos = getRandomInt(0, Math.max(0, CANVAS_WIDTH - COMP_SIZE));
                var y_pos = getRandomInt(0, Math.max(0, CANVAS_HEIGHT - COMP_SIZE));
                var myGamePiece = new component(COMP_SIZE, COMP_SIZE, "red", x_pos, x_pos);
                myGamePieces.push(myGamePiece);
            }
            
            myGameArea.start();
        }

        var myGameArea = {
            canvas : document.createElement("canvas"),
            start : function() {
                this.canvas.id = "myGameCanvas";
                this.canvas.width = CANVAS_WIDTH;
                this.canvas.height = CANVAS_HEIGHT;
                this.context = this.canvas.getContext("2d");
                this.context.font = "20px Arial";
                var txt = "Remaining: " + components_left + "  Clicked: " + components_clicked;
                this.context.fillText(txt, TEXT_POS_X, TEXT_POS_Y);

                document.body.insertBefore(this.canvas, document.body.childNodes[0]);
                this.frameNo = 0;
                this.interval = setInterval(updateGameArea, 20);
            },
            stop : function() {
                clearInterval(this.interval);
            },
            clear : function() {
                this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
            }
        }

        function component(width, height, color, x, y, type) {
            this.type = type;
            this.width = width;
            this.height = height;
            this.speed_x = getRandomInt(MIN_COMP_SPEED, MAX_COMP_SPEED);
            this.speed_y = getRandomInt(MIN_COMP_SPEED, MAX_COMP_SPEED);
            this.x = x;
            this.y = y;
            this.update = function() {
                ctx = myGameArea.context;
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.fillStyle = color;
                ctx.fillRect(this.width / -2, this.height / -2, this.width, this.height);
                ctx.restore();
            }

            this.newPos = function() {
                if (this.x - this.width / 2 < 0)
                    this.speed_x = 2;
                else if ((this.x + this.width / 2) >= myGameArea.context.canvas.width)
                    this.speed_x = -2;

                if (this.y - this.height / 2 < 0)
                    this.speed_y = -2;
                else if ((this.y + this.height / 2) >= myGameArea.context.canvas.height)
                    this.speed_y = 2;

                this.x += this.speed_x;
                this.y -= this.speed_y;
            }
        }

        function updateGameArea() {
            myGameArea.clear();

            for (i = 0; i < myGamePieces.length; i++) {
                myGamePieces[i].newPos();
                myGamePieces[i].update();
            }

            var txt = "Remaining: " + components_left + "  Clicked: " + components_clicked;
            myGameArea.context.fillText(txt, TEXT_POS_X, TEXT_POS_Y);

        }


        
    </script>
    </head>

    <body onload="startGame()">
    </body>

</html>